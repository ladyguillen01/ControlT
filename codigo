Número de parámetros optimizados: 8
Parámetros (vector): [-8.17275000e-03  9.99904670e-01  3.56901059e+02 -6.52352583e+00
 -6.84180000e-04  1.21600000e-05 -3.78252925e+00  7.71711200e-02]
R² = 0.933377
Correlación (Pearson) = 0.966114

#############  estimacion 40
WITH max_maduraciones AS (
  SELECT 
    cosecha,
    MAX(maduracion) AS max_maduracion
  FROM 
    catalog_lhcl_prod_bcp.bcp_edv_rbm.T65734_caldesagregada
  GROUP BY 
    cosecha
),
maduraciones_faltantes AS (
  SELECT 
    t1.cosecha,
    t1.maduracion + 1 AS maduracion
  FROM 
    catalog_lhcl_prod_bcp.bcp_edv_rbm.T65734_caldesagregada t1
  JOIN 
    max_maduraciones t2
  ON 
    t1.cosecha = t2.cosecha
  WHERE 
    t1.maduracion = t2.max_maduracion
    AND t1.maduracion < 44
),
maduraciones_faltantes_con_valores_fijos AS (
  SELECT 
    mf.cosecha,
    mf.maduracion,
    t.saldo_inicial,
    t.pdponderado,
    NULL AS provisionporc,
    NULL AS rango_pd,
    NULL AS porcentajeacum,
    NULL AS codmes,
    NULL AS tipcredito
  FROM 
    maduraciones_faltantes mf
  JOIN 
    catalog_lhcl_prod_bcp.bcp_edv_rbm.T65734_caldesagregada t
  ON 
    mf.cosecha = t.cosecha
  WHERE 
    t.maduracion = (SELECT MAX(maduracion) FROM catalog_lhcl_prod_bcp.bcp_edv_rbm.T65734_caldesagregada WHERE cosecha = mf.cosecha)
),
resultado_final AS (
  SELECT 
    *
  FROM 
    catalog_lhcl_prod_bcp.bcp_edv_rbm.T65734_caldesagregada
  UNION ALL
  SELECT 
    cosecha,
    maduracion,
    saldo_inicial,
    pdponderado,
    provisionporc,
    rango_pd,
    porcentajeacum,
    codmes,
    tipcredito
  FROM 
    maduraciones_faltantes_con_valores_fijos
)
SELECT 
  *
FROM 
  resultado_final
ORDER BY 
  cosecha, maduracion;
