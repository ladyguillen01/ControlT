CREATE or replace table CALENDARIO
AS
SELECT DATE_FORMAT(ADD_MONTHS(CURRENT_DATE, -1), 'yyyyMM') AS CODMES,
       DATE_FORMAT(ADD_MONTHS(CURRENT_DATE, -2), 'yyyyMM') AS CODMES_ANTERIOR,
       DATE_FORMAT(CURRENT_DATE, 'yyyyMM') AS CODMES_SIGUIENTE,
       DATE_FORMAT(LAST_DAY(CURRENT_DATE), 'dd') AS DIAS
UNION ALL
SELECT DATE_FORMAT(ADD_MONTHS(CURRENT_DATE, -2), 'yyyyMM'),
       DATE_FORMAT(ADD_MONTHS(CURRENT_DATE, -3), 'yyyyMM') AS CODMES_ANTERIOR,
       DATE_FORMAT(ADD_MONTHS(CURRENT_DATE, -1), 'yyyyMM') AS CODMES_SIGUIENTE,
       DATE_FORMAT(LAST_DAY(ADD_MONTHS(CURRENT_DATE, -1)), 'dd')
UNION ALL
SELECT DATE_FORMAT(ADD_MONTHS(CURRENT_DATE, -3), 'yyyyMM'),
       DATE_FORMAT(ADD_MONTHS(CURRENT_DATE, -4), 'yyyyMM') AS CODMES_ANTERIOR,
       DATE_FORMAT(ADD_MONTHS(CURRENT_DATE, -2), 'yyyyMM') AS CODMES_SIGUIENTE,
       DATE_FORMAT(LAST_DAY(ADD_MONTHS(CURRENT_DATE, -2)), 'dd')
UNION ALL
SELECT DATE_FORMAT(ADD_MONTHS(CURRENT_DATE, -4), 'yyyyMM'),
       DATE_FORMAT(ADD_MONTHS(CURRENT_DATE, -5), 'yyyyMM') AS CODMES_ANTERIOR,
       DATE_FORMAT(ADD_MONTHS(CURRENT_DATE, -3), 'yyyyMM') AS CODMES_SIGUIENTE,
       DATE_FORMAT(LAST_DAY(ADD_MONTHS(CURRENT_DATE, -3)), 'dd')
UNION ALL
SELECT DATE_FORMAT(ADD_MONTHS(CURRENT_DATE, -5), 'yyyyMM'),
       DATE_FORMAT(ADD_MONTHS(CURRENT_DATE, -6), 'yyyyMM') AS CODMES_ANTERIOR,
       DATE_FORMAT(ADD_MONTHS(CURRENT_DATE, -4), 'yyyyMM') AS CODMES_SIGUIENTE,
       DATE_FORMAT(LAST_DAY(ADD_MONTHS(CURRENT_DATE, -4)), 'dd')
UNION ALL
SELECT DATE_FORMAT(ADD_MONTHS(CURRENT_DATE, -6), 'yyyyMM'),
       DATE_FORMAT(ADD_MONTHS(CURRENT_DATE, -7), 'yyyyMM') AS CODMES_ANTERIOR,
       DATE_FORMAT(ADD_MONTHS(CURRENT_DATE, -5), 'yyyyMM') AS CODMES_SIGUIENTE,
       DATE_FORMAT(LAST_DAY(ADD_MONTHS(CURRENT_DATE, -5)), 'dd')
UNION ALL
SELECT DATE_FORMAT(ADD_MONTHS(CURRENT_DATE, -7), 'yyyyMM'),
       DATE_FORMAT(ADD_MONTHS(CURRENT_DATE, -8), 'yyyyMM') AS CODMES_ANTERIOR,
       DATE_FORMAT(ADD_MONTHS(CURRENT_DATE, -6), 'yyyyMM') AS CODMES_SIGUIENTE,
       DATE_FORMAT(LAST_DAY(ADD_MONTHS(CURRENT_DATE, -6)), 'dd')
UNION ALL
SELECT DATE_FORMAT(ADD_MONTHS(CURRENT_DATE, -8), 'yyyyMM'),
       DATE_FORMAT(ADD_MONTHS(CURRENT_DATE, -9), 'yyyyMM') AS CODMES_ANTERIOR,
       DATE_FORMAT(ADD_MONTHS(CURRENT_DATE, -7), 'yyyyMM') AS CODMES_SIGUIENTE,
       DATE_FORMAT(LAST_DAY(ADD_MONTHS(CURRENT_DATE, -7)), 'dd')
UNION ALL
SELECT DATE_FORMAT(ADD_MONTHS(CURRENT_DATE, -9), 'yyyyMM'),
       DATE_FORMAT(ADD_MONTHS(CURRENT_DATE, -10), 'yyyyMM') AS CODMES_ANTERIOR,
       DATE_FORMAT(ADD_MONTHS(CURRENT_DATE, -8), 'yyyyMM') AS CODMES_SIGUIENTE,
       DATE_FORMAT(LAST_DAY(ADD_MONTHS(CURRENT_DATE, -8)), 'dd')
UNION ALL
SELECT DATE_FORMAT(ADD_MONTHS(CURRENT_DATE, -10), 'yyyyMM'),
       DATE_FORMAT(ADD_MONTHS(CURRENT_DATE, -11), 'yyyyMM') AS CODMES_ANTERIOR,
       DATE_FORMAT(ADD_MONTHS(CURRENT_DATE, -9), 'yyyyMM') AS CODMES_SIGUIENTE,
       DATE_FORMAT(LAST_DAY(ADD_MONTHS(CURRENT_DATE, -9)), 'dd')
UNION ALL
SELECT DATE_FORMAT(ADD_MONTHS(CURRENT_DATE, -11), 'yyyyMM'),
       DATE_FORMAT(ADD_MONTHS(CURRENT_DATE, -12), 'yyyyMM') AS CODMES_ANTERIOR,
       DATE_FORMAT(ADD_MONTHS(CURRENT_DATE, -10), 'yyyyMM') AS CODMES_SIGUIENTE,
       DATE_FORMAT(LAST_DAY(ADD_MONTHS(CURRENT_DATE, -10)), 'dd')
UNION ALL
SELECT DATE_FORMAT(ADD_MONTHS(CURRENT_DATE, -12), 'yyyyMM'),
       DATE_FORMAT(ADD_MONTHS(CURRENT_DATE, -13), 'yyyyMM') AS CODMES_ANTERIOR,
       DATE_FORMAT(ADD_MONTHS(CURRENT_DATE, -11), 'yyyyMM') AS CODMES_SIGUIENTE,
       DATE_FORMAT(LAST_DAY(ADD_MONTHS(CURRENT_DATE, -11)), 'dd')
UNION ALL
SELECT DATE_FORMAT(ADD_MONTHS(CURRENT_DATE, -13), 'yyyyMM'),
       DATE_FORMAT(ADD_MONTHS(CURRENT_DATE, -14), 'yyyyMM') AS CODMES_ANTERIOR,
       DATE_FORMAT(ADD_MONTHS(CURRENT_DATE, -12), 'yyyyMM') AS CODMES_SIGUIENTE,
       DATE_FORMAT(LAST_DAY(ADD_MONTHS(CURRENT_DATE, -12)), 'dd')
UNION ALL
SELECT DATE_FORMAT(ADD_MONTHS(CURRENT_DATE, -14), 'yyyyMM'),
       DATE_FORMAT(ADD_MONTHS(CURRENT_DATE, -15), 'yyyyMM') AS CODMES_ANTERIOR,
       DATE_FORMAT(ADD_MONTHS(CURRENT_DATE, -13), 'yyyyMM') AS CODMES_SIGUIENTE,
       DATE_FORMAT(LAST_DAY(ADD_MONTHS(CURRENT_DATE, -13)), 'dd');
